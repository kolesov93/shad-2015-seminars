\documentclass[addpoints]{exam}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[OT1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{hyperref}
\title{Семинар 4}
\author{Минский ШАД. Весна}

\DeclareMathOperator{\ord}{ord}
\DeclareMathOperator{\suf}{suf}
\DeclareMathOperator{\uniq}{uniq}
\DeclareMathOperator{\cnt}{cnt}

\begin{document}

\maketitle

\section{Комбинаторика}

Дана failure table для некоторой строки $T$ над алфавитом $\Sigma$. Необходимо найти, сколько существует строк $S$ над этим же алфавитом таких, что $T$~--- подстрока $S$.

\textbf{Бонус}. Пусть про строку известно не failure table, а только спектр периодов, т.е. такие числа $n_i$, что $T_k = T_{k+n_i}$ для любых подходящих $k$. Можно ли до сих пор решить задачу?

\section{Хорошо забытое}

Дан массив из $n$ чисел. Назовём <<\textbf{нинздя-парой}>> пару индексов $(x,y)$, если $a_x = a_y$ и $x \neq y$. Стоимостью пары будем называть число $|x - y|$. Надо ответить на $m$ запросов: дано $l$ и $r$, надо найти стоимость самой дешёвой ниндзя-пары, такой что $l \leqslant x < y \leqslant r$.

\begin{itemize}
\item За $\mathcal{O}((n + m) \sqrt{n})$.
\item За $\mathcal{O}(m \log{n})$.
\item Запросы даются в онлайне. Надо отвечать за $\mathcal{O}(\log{n})$ на один запрос. Препроцесс за $\mathcal{O}(n \log{n})$.
\item Надо отвечать не стоимость, а называть самую левую из самых дешёвых ниндзя-пар (запросы в онлайне). Надо отвечать за $\mathcal{O}(\log{n})$ на один запрос. Препроцесс за $\mathcal{O}(n \log{n})$.
\item Надо отвечать не стоимость, а называть такую ниндзя-пару, что $a_x$ минимально (среди самых дешёвых ниндзя-пар). Надо отвечать за $\mathcal{O}(\log{n})$ на один запрос (которые задаются в онлайне). Препроцесс за $\mathcal{O}(n \log{n})$.
\end{itemize}

\section{ДНК-комплектация}

Вам дан стек символов из алфавита $\Sigma = \{A,C,G,T\}$ и изначально пустая строка $S$. За один ход можно достать символ с вершины стека и положить его либо в начало, либо в конец строки $S$. Необходимо узнать, какую минимальную лексикографически строку можно получить, полностью опустошив стек. Содержимое стека известно заранее. Алгоритм должен работать за $\mathcal{O}(n \log{n})$, где $n$~--- размер стека.

\section{Поиск подматрицы}

Дана матрица числовая матрица $n \times m$. Также дан паттерн~--- числовая матрица $k \times l$. Необходимо найти все вхождения паттерна в матрицу. Сложность алгоритма должна быть $\mathcal{O}(nm)$. Алфавит считать константным.

\textbf{Бонус}. Пусть допускается одно различие. Как тогда решить задачу за такую же сложность?

\section{Bubble shot}

Дана строка длины $n$. За один ход можно удалить любое количество подряд идущих одинаковых символов. После этого строка схлопывается (т.е. после удаления центральной группы символов <<a>> строка <<abaaaaaba>> превращается в <<abba>>). Надо найти, за какое минимальное количество ходов можно убрать из строки все символы. Решение должно иметь сложность $\mathcal{O}(n^3)$.

\textbf{Бонус}: Как детерминировано решить задачу за $\overline{o}(n^3)$?

\end{document}
