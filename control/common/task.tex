\documentclass[addpoints]{exam}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage[OT1]{fontenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{graphicx}
\title{Динамическое программирование на деревьях}
\author{Минский ШАД. Осень}

\input{exam_russification.tex}

\begin{document}

\printanswers
\maketitle

\begin{questions}

\section{Тематические задачи}

\question[1] \label{task1} Дерево на $n$ вершинах задано своим списком рёбер. На каждом ребре написан вес $w_{a,b} \in \mathbb{R}$. Необходимо за $\mathcal{O}(n)$ предоставить вес самого тяжелого простого пути (вес пути ~--- сумма весов рёбер). Вес пустого пути считается равным нулю. 

\begin{solution}
Подвесим дерево за любую вершину. Введём величину $f(x)$ равную весу самого тяжелого пути от вершины $x$ до какой-либо вершины её поддерева (включая саму вершину $x$). Введённую величину легко пересчитать через сыновей $S_x$ вершины $x$, а именно: 

$$f(x) = \max\left(0, \max_{y \in S_x}(w_{x,y} + f(y))\right)$$

Вычислять эту величину можно с помощью обхода в глубину.

Теперь для каждой вершины $x$ найдём $g(x)$ ~--- вес самого тяжёлого простого пути среди таких, что вершина $x$ является самой близкой (по количеству рёбер) к корню вершиной этого пути. Очевидно, что вес такого пути либо равен $f(x)$, либо $\max\limits_{y_1 \in S_x, y_2 \in S_x, y1 \neq y2} f(y_1) + w_{x, y_1} + f(y_2) + w_{x, y_2}$. Последнюю величину легко вычислить за $\mathcal{O}(|S_x|)$ ~--- нужно просто найти два максимума $f(y) + w_{x, y}$ по $S_x$. 

Таким образом, ответ на задачу ~--- $\max\limits_x g(x)$

\end{solution}

\question[3] По дереву на $n$ вершинах определить сколько существует различных (с точностью до переименования цветов) способов раскрасить дерево в $m$ цветов, при условии, что вершины одного цвета должны образовывать связное множество.

\section{Задачи на повторение}

\question[1] Задано прямоугольное поле размерами $n \times m$. В клетке с координатами $(i,j)$ находится ровно $a_{i,j} \in \mathbb{N}$ котиков. Нужно найти такой путь из клетки $(1,1)$ в клетку $(n, m)$, что суммарное количество котиков на пути будет максимально. Двигаться по пути можно только вправо, либо только вниз (т.е разрешённые ходы $(i,j) \rightarrow (i+1,j)$ либо $(i,j) \rightarrow (i, j+1)$). Время работы должно составлять $\mathcal{O}(nm)$   
\question Задано поле, как в предыдущей задаче. Путь из клетки $(1,1)$ в клетку $(n,m)$, двигаясь только вправо либо вниз, назовём <<путём сильной и независимой женщины>>. По пути сильная независимая женщина может в каждой клеток взять или не взять ровно одного кота (т.е. из одной клетки можно взять только одного, но можно брать хоть в каждой клетке пути). Надо сказать, сколько минимум нужно сильных независимых женщин, чтоб собрать всех котов с поля.

\begin{parts}

\part[1] Время решения должно быть $\mathcal{O}\left(nm \times \sum{a_{i,j}}\right)$
\part[2] Время решения должно быть $\mathcal{O}(nm)$

\end{parts}

\section{Практические задачи}

\question[1] Реализуйте решение задачи \ref{task1} (\url{http://unexisting/link/to/contest.yandex.ru}).

\question[1] Реализуйте задачу бинаризации корневного дерева
(\url{http://second/unexisting/link/to/contest.yandex.ru}).

\end{questions}


\begin{center}
\pointtable[h][questions]
\end{center}


\end{document}